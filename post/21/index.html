<!doctype html><html lang=ko-KR dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="각 계층에서의 DTO의 분리를 해야하는 이유"><title>[Spring Boot] Controller, Service, Repository에서의 DTO 분리 그리고 네이밍에 대해서</title>
<link rel=canonical href=https://fhdufhdu.github.io/post/21/><link rel=stylesheet href=/scss/style.min.abbd69b2908fdfcd5179898beaafd374514a86538d81639ddd2c58c06ae54e40.css><meta property="og:title" content="[Spring Boot] Controller, Service, Repository에서의 DTO 분리 그리고 네이밍에 대해서"><meta property="og:description" content="각 계층에서의 DTO의 분리를 해야하는 이유"><meta property="og:url" content="https://fhdufhdu.github.io/post/21/"><meta property="og:site_name" content="fhdufhdu"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:published_time" content="2024-04-30T09:00:00+09:00"><meta property="article:modified_time" content="2024-04-30T09:00:00+09:00"><meta name=twitter:title content="[Spring Boot] Controller, Service, Repository에서의 DTO 분리 그리고 네이밍에 대해서"><meta name=twitter:description content="각 계층에서의 DTO의 분리를 해야하는 이유"><script async src="https://www.googletagmanager.com/gtag/js?id=G-7HWJJYSR48"></script><script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-7HWJJYSR48",{anonymize_ip:!1})}</script><link rel=icon href=https://fhdufhdu.github.io/favicon.png><meta name=naver-site-verification content="6d753ef05b036bf72e177ec56685c036c230f81e"><meta name=google-site-verification content="Qvwxie2h5X0Fo-VCDyLZnJ8tNGARZmDZTZNVmsfWCVg"><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono&display=swap" rel=stylesheet><style>@font-face{font-family:d2coding;src:url(/font/D2Coding.ttf)format('truetype');font-weight:400;font-style:normal}@font-face{font-family:pretendard;src:url(/font/pretendard/100.woff2)format('woff2');font-weight:100;font-style:normal}@font-face{font-family:pretendard;src:url(/font/pretendard/200.woff2)format('woff2');font-weight:200;font-style:normal}@font-face{font-family:pretendard;src:url(/font/pretendard/300.woff2)format('woff2');font-weight:300;font-style:normal}@font-face{font-family:pretendard;src:url(/font/pretendard/400.woff2)format('woff2');font-weight:400;font-style:normal}@font-face{font-family:pretendard;src:url(/font/pretendard/500.woff2)format('woff2');font-weight:500;font-style:normal}@font-face{font-family:pretendard;src:url(/font/pretendard/600.woff2)format('woff2');font-weight:600;font-style:normal}@font-face{font-family:pretendard;src:url(/font/pretendard/700.woff2)format('woff2');font-weight:700;font-style:normal}@font-face{font-family:pretendard;src:url(/font/pretendard/800.woff2)format('woff2');font-weight:800;font-style:normal}@font-face{font-family:pretendard;src:url(/font/pretendard/900.woff2)format('woff2');font-weight:900;font-style:normal}:root{--base-font-family:"Pretendard","Lato", var(--sys-font-family), var(--zh-font-family), sans-serif !important;--code-font-family:"JetBrains Mono", "Pretendard", Menlo, Monaco, Consolas, "Courier New", var(--zh-font-family), monospace!important;font-size:x-small;line-height:normal;.highlight { background-color: #272822; }}</style></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu95e3a12c0d9210c5dbd751eba0336b86_24679_300x0_resize_q75_box.jpeg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>🤩</span></figure><div class=site-meta><h1 class=site-name><a href=/>fhdufhdu</a></h1><h2 class=site-description>의미있는 경험과 지식을 공유합니다.</h2></div></header><ol class=social-menu><li><a href=https://github.com/fhdufhdu target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/page/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>About</span></a></li><li><a href><span>=====================</span></a></li><li><a href=https://github.com/joohyeson/FunctionalProgrammingStudy><span>📖 함수형 프로그래밍 스터디</span></a></li><div class=menu-bottom-section><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></div></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">Table of contents</h2><div class=widget--toc><nav id=TableOfContents><ul><li><a href=#들어가며>들어가며</a></li><li><a href=#request-dto를-모든-곳에서-사용하지-말자>Request DTO를 모든 곳에서 사용하지 말자</a></li><li><a href=#dto를-모든-계층에서-분리하자>DTO를 모든 계층에서 분리하자!</a><ul><li><a href=#게시글-목록-조회>게시글 목록 조회</a></li></ul></li><li><a href=#마무리하며>마무리하며</a></li></ul></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/spring-boot/>Spring Boot
</a><a href=/categories/kotlin/>Kotlin
</a><a href=/categories/kotlin-+-spring-boot-%EA%B0%9C%EB%B0%9C%EA%B8%B0/>Kotlin + Spring Boot 개발기</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/post/21/>[Spring Boot] Controller, Service, Repository에서의 DTO 분리 그리고 네이밍에 대해서</a></h2><h3 class=article-subtitle>각 계층에서의 DTO의 분리를 해야하는 이유</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2024-04-30 AM 9:00</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>3 minute read</time></div></footer></div></header><section class=article-content><a href=https://hits.seeyoufarm.com><img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Ffhdufhdu.github.io%2Fpost%2F21%2F&count_bg=%2351C7FF&title_bg=%23848484&icon=&icon_color=%23E7E7E7&title=hits&edge_flat=true"></a><h2 id=들어가며>들어가며</h2><p>오랜만에 포스팅하게 되었다. 그동안 회사도 바빴고, 개인적으로 Spring boot를 이용한 게시판을 만들고 있었다. 예전과는 다르게, 실무에서 겪었던 문제들을 바탕으로 해결책들을 녹여내기 위해서 노력했다. (<a class=link href=http://fhdufhdu.hopto.org target=_blank rel=noopener>해당 게시판</a> &mldr;홍보도 겸사겸사)</p><p>사실 백엔드 개발을 하며 제일 크게 문제라고 느꼈던 건, 네이밍과 관심사 분리였다.</p><p>필자는 서버를 Controller, Service, Repository, Infrasturcture 계층으로 나누어서 주로 개발한다. 여기까지는 관습적으로 잘 지켜오고 있었는데, 그 외의 DTO가 문제였다.</p><p>이에 대한 이야기와, 나름대로 해결책을 정리해 보겠다.</p><h2 id=request-dto를-모든-곳에서-사용하지-말자>Request DTO를 모든 곳에서 사용하지 말자</h2><p>제일 크게 문제였던 것은, Request DTO였다. 필자는 이전까지 Request DTO를 모든 계층에서 돌려쓸 때가 있었다.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FooController</span>(
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>val</span> fooService: FooService
</span></span><span style=display:flex><span>){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getData</span>(<span style=color:#a6e22e>@RequestBody</span>() body: DataRequest){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> fooService.fetchData(body)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>FooService</span>(
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>val</span> fooRepository: FooRepository
</span></span><span style=display:flex><span>){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>fetchData</span>(body: DataRequest){
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> fooRepository.findOne(body.id)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>해당 코드를 보면 Controller, Service 계층에서 같은 DataRequest 를 쓰고 있다.</p><p>실제로 겪어본 결과, 이 방식은 문제점이 많았다.</p><ol><li><code>FooService</code>의 <code>fetchData</code> 메소드는 <code>FooController</code>에서만 사용되는 것이 아니다.<ul><li>다른 곳에서 사용될 수가 있을 텐데, 파라미터가 <code>DataRequest</code>인 것은 이상하다. 마치 <code>FooController</code>에 종속된 것처럼 보인다.</li></ul></li><li><code>DataRequest</code>가 변경되면 모든 레이어에 영향을 끼친다. 이때 컴파일 시 에러가 발생하지 않고 런타임 때 발생할 수 있다.<ul><li>이를 추적하여 수정하는 것은 많은 비용이 든다.</li></ul></li></ol><p>그렇다면 어떻게 해야 할까&mldr;?</p><h2 id=dto를-모든-계층에서-분리하자>DTO를 모든 계층에서 분리하자!</h2><p>문제를 해결하기 위해 모든 계층에서 DTO를 만들어보려고 했다. 다만 이럴 때 문제점은 DTO 이름이 너무나도 중복이 많이 되는 것이 문제였다.</p><p>그래서 주위에 물어보거나, 많은 자료조사 끝에, 나름대로 철칙을 만들었다.</p><ol><li>모든 계층에서의 parameter, return type을 분리한다.</li><li>네이밍을 아래와 같이 정한다.<ul><li>Controller<ul><li>prameter: <code>...Request</code></li><li>return: <code>...Response</code></li></ul></li><li>Service<ul><li>parameter: <code>...Command</code>,</li><li>return: 서비스 메소드에 맞게 정한다.</li></ul></li><li>Repository<ul><li>parameter: <code>...Condition</code></li><li>return: <code>...Projection</code></li></ul></li></ul></li></ol><p>이렇게 분리하게 되면, 앞서 이야기한 문제가 해결된다. 단점은 DTO를 많이 만들고 수정해야 한다는 것이다. 하지만 런타임 에러를 방지한다는 목적으로 보자면 매우 효율적인 비용이라고 생각한다.</p><p>이제 적용 예시를 보자.</p><h3 id=게시글-목록-조회>게시글 목록 조회</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-kotlin data-lang=kotlin><span style=display:flex><span><span style=color:#75715e>// 컨트롤러
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>@Controller</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BoardController</span>(
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>val</span> boardService: BoardService
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@PreAuthorize</span>(<span style=color:#e6db74>&#34;permitAll&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>@GetMapping</span>(<span style=color:#e6db74>&#34;posts&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>getPostSummaries</span>(<span style=color:#a6e22e>@Valid</span> <span style=color:#a6e22e>@ModelAttribute</span> query: PostSummariesRequest): PostSummaries {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> page = <span style=color:#a6e22e>PostSummariesCommand</span>.Page(query.pageNumber, query.pageSize)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> sort = <span style=color:#a6e22e>PostSummariesCommand</span>.Sort(query.sortCriteria, query.sortDirection)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>var</span> search: <span style=color:#a6e22e>PostSummariesCommand</span>.Search? = <span style=color:#66d9ef>null</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (query.searchQuery <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span> <span style=color:#f92672>&amp;&amp;</span> query.searchCriteria <span style=color:#f92672>!=</span> <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>            search = <span style=color:#a6e22e>PostSummariesCommand</span>.Search(query.searchQuery<span style=color:#f92672>!!</span>, query.searchCriteria<span style=color:#f92672>!!</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> findPostsInput = PostSummariesCommand(page, sort, search)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> boardService.filterPostSummaries(findPostsInput)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>//서비스
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#a6e22e>@Service</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>BoardService</span>(
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>val</span> postRepository: PostRepository,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>val</span> commentRepository: CommentRepository,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>val</span> userRepository: UserRepository
</span></span><span style=display:flex><span>) {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>filterPostSummaries</span>(input: PostSummariesCommand): PostSummaries {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> orderCondition = <span style=color:#a6e22e>PostSummariesCondition</span>.Order(input.sort.direction.queryDslOrder, input.sort.criteria.<span style=color:#66d9ef>value</span>)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> searchCondition = <span style=color:#a6e22e>PostSummariesCondition</span>.Search(input.search<span style=color:#f92672>?.</span>searchQuery, input.search<span style=color:#f92672>?.</span>searchCriteria<span style=color:#f92672>?.</span><span style=color:#66d9ef>value</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 페이지네이션 조건 객체
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>val</span> pageable = <span style=color:#a6e22e>PageRequest</span>.of(input.page.number, input.page.size)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 객체 조회
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>val</span> page = postRepository.findPostSummaries(PostSummariesCondition(searchCondition, orderCondition), pageable)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> postDtoList = page.content.stream().map {
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>PostSummaries</span>.PostSummary(<span style=color:#66d9ef>it</span>.id, <span style=color:#66d9ef>it</span>.userId, <span style=color:#66d9ef>it</span>.title, <span style=color:#66d9ef>it</span>.content, <span style=color:#66d9ef>it</span>.createdAt, <span style=color:#66d9ef>it</span>.updatedAt)
</span></span><span style=display:flex><span>        }.toList()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> PostSummaries(postDtoList, page.number, page.totalPages, page.totalElements)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#75715e>// QueryDSL
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>PostQueryDslImpl</span>(
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>val</span> queryFactory: JPAQueryFactory
</span></span><span style=display:flex><span>) : PostQueryDsl {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>override</span> <span style=color:#66d9ef>fun</span> <span style=color:#a6e22e>findPostSummaries</span>(condition: PostSummariesCondition, pageable: Pageable): Page&lt;PostSummariesProjection&gt; {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> post = <span style=color:#a6e22e>QPost</span>.post
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> whereConditions = arrayOf(<span style=color:#a6e22e>QPost</span>.post.status.eq(<span style=color:#a6e22e>Post</span>.<span style=color:#a6e22e>Status</span>.PUBLISHED), condition.search.searchExpression)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 쿼리
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>val</span> query = queryFactory
</span></span><span style=display:flex><span>            .select(
</span></span><span style=display:flex><span>                <span style=color:#a6e22e>Projections</span>.<span style=color:#66d9ef>constructor</span>(
</span></span><span style=display:flex><span>                    PostSummariesProjection<span style=color:#f92672>::</span><span style=color:#66d9ef>class</span>.java,
</span></span><span style=display:flex><span>                    post.id,
</span></span><span style=display:flex><span>                    post.user.id,
</span></span><span style=display:flex><span>                    post.title,
</span></span><span style=display:flex><span>                    post.content.substring(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>30</span>),
</span></span><span style=display:flex><span>                    post.createdAt,
</span></span><span style=display:flex><span>                    post.updatedAt
</span></span><span style=display:flex><span>                )
</span></span><span style=display:flex><span>            )
</span></span><span style=display:flex><span>            .from(post)
</span></span><span style=display:flex><span>            .<span style=color:#66d9ef>where</span>(*whereConditions)
</span></span><span style=display:flex><span>            .orderBy(condition.order.orderSpecifier)
</span></span><span style=display:flex><span>            .offset(pageable.offset)
</span></span><span style=display:flex><span>            .limit(pageable.pageSize.toLong())
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> countQuery = queryFactory
</span></span><span style=display:flex><span>            .select(post.count())
</span></span><span style=display:flex><span>            .from(post)
</span></span><span style=display:flex><span>            .<span style=color:#66d9ef>where</span>(*whereConditions)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e>// 쿼리 실행
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>val</span> posts = query.fetch()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>val</span> count = countQuery.fetchOne()<span style=color:#f92672>!!</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> PageImpl(posts, pageable, count)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>모든 계층에서, 자신의 DTO를 다른 계층의 DTO로 변환해서 호출하는 것을 볼 수 있다. 이런 방식을 통해 하나의 DTO가 변경되더라도 런타임 에러를 방지할 수 있다.</p><h2 id=마무리하며>마무리하며</h2><p>DTO 이슈는 현업을 진행하며 많이 고민이 되었던 문제였다. 이번에 Spring 개발을 진행하며 나름대로 생각 정리가 되어서 후련하다. 사실 이번 DTO 관련 이슈를 제외하고서도 나름대로 정리된 내용이 많다. 다음 포스팅에서는 DTO의 역할에 대해서도 생각을 정리해 보는 시간을 가져보도록 하겠다.</p></section><footer class=article-footer></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css integrity="sha256-J+iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s=" crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js integrity="sha256-InsNdER1b2xUewP+pKCUJpkhiqwHgqiPXDlIk7GzBu4=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI=" crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.querySelector(`.article-content`),{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><script src=https://utteranc.es/client.js repo=fhdufhdu/fhdufhdu.github.io issue-term=pathname label=comment crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>let utterancesLoaded=!1;function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;utterancesLoaded=!0,setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{if(!utterancesLoaded)return;setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2023 -
2024 fhdufhdu</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.21.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>